(()=>{"use strict";var e={n:r=>{var t=r&&r.__esModule?()=>r.default:()=>r;return e.d(t,{a:t}),t},d:(r,t)=>{for(var o in t)e.o(t,o)&&!e.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:t[o]})},o:(e,r)=>Object.prototype.hasOwnProperty.call(e,r)};const r=window.wp.hooks,t=window.wp.i18n;class o{static ID="cloudflare-r2-static-site";static NAME=(0,t.__)("Cloudflare R2","aether-site-exporter-providers");static TYPE="cloud-storage";static DESCRIPTION=(0,t.__)("Cloudflare R2 object storage for static site exports with zero egress fees.","aether-site-exporter-providers");static ICON="☁️";static DEPLOYMENT_TYPE="static_site";static CONFIG_FIELDS=[{id:"account_id",label:(0,t.__)("Cloudflare Account ID","aether-site-exporter-providers"),type:"text",required:!0,sensitive:!0,validation:{pattern:"^[a-f0-9]{32}$",message:(0,t.__)("Account ID must be a 32-character hexadecimal string","aether-site-exporter-providers")}},{id:"api_token",label:(0,t.__)("Cloudflare API Token","aether-site-exporter-providers"),type:"text",required:!0,sensitive:!0,validation:{minLength:20,message:(0,t.__)("API Token must be at least 20 characters","aether-site-exporter-providers")}},{id:"bucket_name",label:(0,t.__)("Bucket Name","aether-site-exporter-providers"),type:"text",required:!0,sensitive:!1,validation:{pattern:"^[a-z0-9][a-z0-9-]{1,61}[a-z0-9]$",minLength:3,maxLength:63,message:(0,t.__)("Bucket name must be 3-63 characters, start and end with alphanumeric, and contain only lowercase letters, numbers, and hyphens","aether-site-exporter-providers")}},{id:"public_url",label:(0,t.__)("Custom Domain (Optional)","aether-site-exporter-providers"),type:"url",required:!1,sensitive:!1,help:(0,t.__)("The custom domain for your static site (e.g., https://example.com). If provided, the Deploy Worker button will automatically attach it to the worker.","aether-site-exporter-providers")},{id:"worker_endpoint",label:(0,t.__)("Worker Endpoint URL","aether-site-exporter-providers"),type:"url",required:!1,sensitive:!1,help:(0,t.__)("URL of the deployed Cloudflare Worker. Use the Deploy Worker button below to create one.","aether-site-exporter-providers")},{id:"access_key_id",label:(0,t.__)("R2 Access Key ID","aether-site-exporter-providers"),type:"text",required:!1,sensitive:!0,help:(0,t.__)("Only required for S3-compatible API access, not for Worker-based uploads.","aether-site-exporter-providers"),validation:{minLength:16,maxLength:128,message:(0,t.__)("Access Key ID must be between 16 and 128 characters","aether-site-exporter-providers")}},{id:"secret_access_key",label:(0,t.__)("R2 Secret Access Key","aether-site-exporter-providers"),type:"text",required:!1,sensitive:!0,help:(0,t.__)("Only required for S3-compatible API access, not for Worker-based uploads.","aether-site-exporter-providers"),validation:{minLength:32,maxLength:128,message:(0,t.__)("Secret Access Key must be between 32 and 128 characters","aether-site-exporter-providers")}}]}const s=window.wp.element,i=window.wp.components,n=window.wp.apiFetch;var a=e.n(n);const d=new Map;function c(e){return`${e.method||"GET"}:${e.path||""}:${e.data?JSON.stringify(e.data):""}`}const l=(e,r)=>{const t=c(e);if(d.has(t))return d.get(t);const o=r(e);return d.set(t,o),o.finally(()=>{d.delete(t)}),o},p=new Map,u={"/assets":6e5,"/settings":6e4,"/config":18e5,"/check-wporg":36e5};const h=(e,r)=>{if("GET"!==(e.method||"GET"))return r(e);const t=c(e),o=p.get(t);if(function(e,r){if(!e)return!1;const t=function(e){for(const[r,t]of Object.entries(u))if(e&&e.includes(r))return t;return 3e5}(r);return 0!==t&&Date.now()-e.timestamp<t}(o,e.path))return Promise.resolve(o.response);const s=r(e);return s.then(e=>(p.set(t,{response:e,timestamp:Date.now()}),e)).catch(e=>{throw e}),s};!function(){const e="undefined"!=typeof window&&window.aetherData&&window.aetherData.restUrl?window.aetherData.restUrl:"/wp-json/",r="undefined"!=typeof window&&window.aetherData&&window.aetherData.nonce?window.aetherData.nonce:"";a().use(a().createRootURLMiddleware(e)),r&&function(e){a().use(a().createNonceMiddleware(e))}(r),a().use(h),a().use(l)}();const m=a();function f(e,r){if(!e)return r;try{const t=JSON.parse(e);return t.errors&&Array.isArray(t.errors)&&t.errors.length>0&&t.errors[0].message?t.errors[0].message:t.error?"string"==typeof t.error?t.error:JSON.stringify(t.error):t.message?t.message:r}catch(t){return e||r}}function y(e=null,r=null){const t={success:!0,data:e};return r&&"object"==typeof e&&null!==e?t.data={...e,message:r}:r&&(t.data={message:r}),t}function x(e,r=null){const t={success:!1,error:"string"==typeof e?e:e?.message||"Unknown error"};return r&&Array.isArray(r)&&r.length>0&&(t.errors=r),t}const w=Object.prototype.toString,_=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed","fetch failed","terminated"," A network error occurred.","Network connection lost"]);function g(e,r,{min:t=0,allowInfinity:o=!1}={}){if(void 0!==r){if("number"!=typeof r||Number.isNaN(r))throw new TypeError(`Expected \`${e}\` to be a number${o?" or Infinity":""}.`);if(!o&&!Number.isFinite(r))throw new TypeError(`Expected \`${e}\` to be a finite number.`);if(r<t)throw new TypeError(`Expected \`${e}\` to be ≥ ${t}.`)}}class k extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,({message:e}=e)):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}function v(e,r){return Number.isFinite(r)?r-(performance.now()-e):r}async function b({error:e,attemptNumber:r,retriesConsumed:t,startTime:o,options:s}){const i=e instanceof Error?e:new TypeError(`Non-error was thrown: "${e}". You should only throw errors.`);if(i instanceof k)throw i.originalError;const n=Number.isFinite(s.retries)?Math.max(0,s.retries-t):s.retries,a=s.maxRetryTime??Number.POSITIVE_INFINITY,d=Object.freeze({error:i,attemptNumber:r,retriesLeft:n,retriesConsumed:t});if(await s.onFailedAttempt(d),v(o,a)<=0)throw i;const c=await s.shouldConsumeRetry(d),l=v(o,a);if(l<=0||n<=0)throw i;if(i instanceof TypeError&&!function(e){var r;if(!e||(r=e,"[object Error]"!==w.call(r))||"TypeError"!==e.name||"string"!=typeof e.message)return!1;const{message:t,stack:o}=e;return"Load failed"===t?void 0===o||"__sentry_captured__"in e:!!t.startsWith("error sending request for url")||_.has(t)}(i)){if(c)throw i;return s.signal?.throwIfAborted(),!1}if(!await s.shouldRetry(d))throw i;if(!c)return s.signal?.throwIfAborted(),!1;const p=function(e,r){const t=Math.max(1,e+1),o=r.randomize?Math.random()+1:1;let s=Math.round(o*r.minTimeout*r.factor**(t-1));return s=Math.min(s,r.maxTimeout),s}(t,s),u=Math.min(p,l);return u>0&&await new Promise((e,r)=>{const t=()=>{clearTimeout(o),s.signal?.removeEventListener("abort",t),r(s.signal.reason)},o=setTimeout(()=>{s.signal?.removeEventListener("abort",t),e()},u);s.unref&&o.unref?.(),s.signal?.addEventListener("abort",t,{once:!0})}),s.signal?.throwIfAborted(),!0}class j{constructor(e,r,t={},o="cloudflare"){this.accountId=e,this.apiToken=r,this.config=t,this.providerId=o,this.cloudflareApiBase="https://api.cloudflare.com/client/v4"}async cloudflareApiRequest(e,r={}){const t=`${this.cloudflareApiBase}${e}`,o={...function(e,r="Bearer"){return{Authorization:`${r} ${e}`,"Content-Type":"application/json"}}(this.apiToken),...r.headers||{}};try{const e=await async function(e,r={}){if(function(e){if("number"==typeof e){if(e<0)throw new TypeError("Expected `retries` to be a non-negative number.");if(Number.isNaN(e))throw new TypeError("Expected `retries` to be a valid number or Infinity, got NaN.")}else if(void 0!==e)throw new TypeError("Expected `retries` to be a number or Infinity.")}((r={...r}).retries),Object.hasOwn(r,"forever"))throw new Error("The `forever` option is no longer supported. For many use-cases, you can set `retries: Infinity` instead.");r.retries??=10,r.factor??=2,r.minTimeout??=1e3,r.maxTimeout??=Number.POSITIVE_INFINITY,r.maxRetryTime??=Number.POSITIVE_INFINITY,r.randomize??=!1,r.onFailedAttempt??=()=>{},r.shouldRetry??=()=>!0,r.shouldConsumeRetry??=()=>!0,g("factor",r.factor,{min:0,allowInfinity:!1}),g("minTimeout",r.minTimeout,{min:0,allowInfinity:!1}),g("maxTimeout",r.maxTimeout,{min:0,allowInfinity:!0}),g("maxRetryTime",r.maxRetryTime,{min:0,allowInfinity:!0}),r.factor>0||(r.factor=1),r.signal?.throwIfAborted();let t=0,o=0;const s=performance.now();for(;!Number.isFinite(r.retries)||o<=r.retries;){t++;try{r.signal?.throwIfAborted();const o=await e(t);return r.signal?.throwIfAborted(),o}catch(e){await b({error:e,attemptNumber:t,retriesConsumed:o,startTime:s,options:r})&&o++}}throw new Error("Retry attempts exhausted without throwing an error.")}(async()=>await fetch(t,{...r,headers:o}),{retries:3,minTimeout:1e3,maxTimeout:3e4,shouldRetry:e=>"TypeError"===e.name&&e.message.includes("fetch")}),s=await e.json();if(!e.ok||!s.success){return x(f(JSON.stringify(s),"Cloudflare API request failed"),s.errors||[])}return y({result:s.result})}catch(e){return x(e.message||"Network request failed")}}async deploy(e,r,t={},o=!1){if(o){const r=this.generateWorkerName(e);return y({workerName:r+"-dry-run",workerUrl:this.getWorkerUrlFromName(r+"-dry-run")},"Dry run successful")}const s=this.generateWorkerName(e);if("r2"===e)try{const e=await m({path:"/aether/v1/providers/cloudflare-r2/deploy-worker",method:"POST",data:{worker_name:s,script:r,bindings:t}});return e.success?y({workerName:e.worker_name,workerUrl:e.worker_url}):x(e.error||"Worker deployment failed")}catch(e){return x(e.message||"Worker deployment failed")}try{const e=new FormData,o=new Blob([r],{type:"application/javascript+module"});e.append("worker.js",o,"worker.js");const i={main_module:"worker.js",bindings:[]};for(const[e,r]of Object.entries(t))"r2_bucket"===r.type&&i.bindings.push({type:"r2_bucket",name:e,bucket_name:r.bucket_name});e.append("metadata",new Blob([JSON.stringify(i)],{type:"application/json"}),"metadata.json");const n=`/accounts/${this.accountId}/workers/scripts/${s}`,a=await this.cloudflareApiRequest(n,{method:"PUT",body:e});if(!a.success)return x(a.error||"Worker deployment failed");const d=this.getWorkerUrlFromName(s);return await this.enableWorkersDevSubdomain(s),y({workerName:s,workerUrl:d})}catch(e){return x(e.message||"Worker deployment failed")}}async enableWorkersDevSubdomain(e){try{const r=`/accounts/${this.accountId}/workers/subdomain`,t=await this.cloudflareApiRequest(r,{method:"GET"});if(!t.success)return x(t.error);const o=t.data?.result?.subdomain;if(!o)return x("No subdomain configured");const s=`/accounts/${this.accountId}/workers/scripts/${e}/subdomain`,i=await this.cloudflareApiRequest(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:!0})});return i.success?y():x(i.error)}catch(e){return x(e.message)}}async testDeployment(e,r=""){if(!r)return y({deployed:!1},"Worker not deployed");try{const e=await this.listWorkers();if(!e.success)return x(e.error||"Failed to verify API token permissions")}catch(e){return x(e.message||"Token permission test failed")}const t=this.extractWorkerNameFromUrl(r);if(t)try{if((await this.getWorker(t)).success)return y({deployed:!0,workerUrl:r},"Worker is deployed and accessible")}catch{}return y({deployed:!0,workerUrl:r},"Worker URL provided but verification failed")}async listWorkers(){const e=`/accounts/${this.accountId}/workers/scripts`,r=await this.cloudflareApiRequest(e,{method:"GET"});return r.success?y({workers:r.data?.result||[]}):x(r.error||"Failed to list workers")}async getWorker(e){const r=`/accounts/${this.accountId}/workers/scripts/${e}`,t=await this.cloudflareApiRequest(r,{method:"GET"});return t.success?y({worker:t.data?.result}):x(t.error||"Failed to get worker info")}async getZoneIdForHostname(e){const r=`/zones?name=${encodeURIComponent(e)}`,t=await this.cloudflareApiRequest(r,{method:"GET"});if(!t.success)return x(t.error||"Failed to get zone ID");const o=t.data?.result||[];return 0===o.length?x(`No zone found for hostname: ${e}`):y({zoneId:o[0].id,zoneName:o[0].name})}async attachWorkerToCustomDomain(e,r,t){const o=r.replace(/^https?:\/\//,"").replace(/\/.*$/,""),s=`/accounts/${this.accountId}/workers/domains`,i=await this.cloudflareApiRequest(s,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({environment:"production",hostname:o,service:e,zone_id:t,override_existing_dns_record:!0})});return i.success?y(null,`Worker attached to ${o}`):x(i.error||"Failed to attach worker to custom domain")}async testConnection(e=""){const r={success:!0,workersApi:!1,r2Access:!1,errors:[]};try{const e=await this.listWorkers();e.success?r.workersApi=!0:(r.errors.push(`Workers API: ${e.error}`),r.success=!1)}catch(e){r.errors.push(`Workers API: ${e.message}`),r.success=!1}if(e)try{const t="connection-test-"+Date.now(),o=`${e.replace(/\/+$/,"")}/${t}/test.html`,s=await fetch(o,{method:"GET"});404===s.status||s.ok?r.r2Access=!0:(r.errors.push(`R2 Worker: HTTP ${s.status}`),r.success=!1)}catch(e){r.errors.push(`R2 Worker: ${e.message}`),r.success=!1}return r}getWorkerUrl(){return this.config.worker_endpoint||""}isDeployed(e){return!!this.getWorkerUrl(e)}async getWorkerScript(e=null,r=""){if(!r&&e&&(r=e,e=null),!r)return"";const t=e||this.providerId;try{const e=await m({path:`/aether/v1/providers/${t}/edge/worker-script/${r}`,method:"GET"});return"string"==typeof e?e:""}catch{return""}}getWorkerBindings(e,r){if("r2"===e){const e=r.bucket_name||"";return e?{R2_BUCKET:{type:"r2_bucket",bucket_name:e}}:{}}return{}}generateWorkerName(e){return`aether-${e}-${Math.random().toString(36).substring(2,10)}`}getWorkerUrlFromName(e){return`https://${e}.workers.dev`}extractWorkerNameFromUrl(e){const r=e.match(/https?:\/\/([^.]+)\.workers\.dev/);return r?r[1]:null}}const T={title:(0,t.__)("Required API Token Permissions","aether-site-exporter-providers"),sections:[{title:(0,t.__)("R2 Storage","aether-site-exporter-providers"),items:[{permission:"R2: Edit",description:(0,t.__)("Read and write files to R2 bucket","aether-site-exporter-providers")}]},{title:(0,t.__)("Workers (for deployment)","aether-site-exporter-providers"),items:[{permission:"Workers Scripts: Edit",description:(0,t.__)("Deploy and update Workers","aether-site-exporter-providers")},{permission:"Workers Routes: Edit",description:(0,t.__)("Attach custom domains to Workers","aether-site-exporter-providers")}]},{title:(0,t.__)("DNS (for custom domains)","aether-site-exporter-providers"),items:[{permission:"Zone: Read",description:(0,t.__)("Look up zone IDs for custom domains","aether-site-exporter-providers")}]}],createTokenUrl:"https://dash.cloudflare.com/profile/api-tokens"},C={title:(0,t.__)("Manual Worker Deployment","aether-site-exporter-providers"),steps:[(0,t.__)("Go to Cloudflare Dashboard > Workers & Pages","aether-site-exporter-providers"),(0,t.__)('Click "Create" and select "Create Worker"',"aether-site-exporter-providers"),(0,t.__)('Name your worker (e.g., "my-r2-static-site")',"aether-site-exporter-providers"),(0,t.__)("Go to Settings > Variables > R2 Bucket Bindings","aether-site-exporter-providers"),(0,t.__)('Add binding: Variable name "R2_BUCKET", select your bucket',"aether-site-exporter-providers"),(0,t.__)("Deploy the worker and copy the URL","aether-site-exporter-providers")],workersUrl:"https://dash.cloudflare.com/?to=/:account/workers-and-pages"},I={title:(0,t.__)("Manual Domain Attachment","aether-site-exporter-providers"),steps:[(0,t.__)("Go to Cloudflare Dashboard > Workers & Pages","aether-site-exporter-providers"),(0,t.__)("Select your worker","aether-site-exporter-providers"),(0,t.__)("Go to Settings > Triggers > Custom Domains","aether-site-exporter-providers"),(0,t.__)('Click "Add Custom Domain"',"aether-site-exporter-providers"),(0,t.__)("Enter your domain and confirm","aether-site-exporter-providers")],note:(0,t.__)("Ensure the domain is on the same Cloudflare account and proxied through Cloudflare (orange cloud).","aether-site-exporter-providers"),docsUrl:"https://developers.cloudflare.com/workers/configuration/routing/custom-domains/"},E="https://developers.cloudflare.com/workers/runtime-apis/bindings/",S=window.ReactJSXRuntime;function R(){const[e,r]=(0,s.useState)(!1),o={margin:"0.5rem 0 0.75rem",paddingLeft:"1.5rem"},n={marginBottom:"0.25rem"};return(0,S.jsxs)("div",{style:{marginBottom:"1rem",padding:"0.75rem 1rem",backgroundColor:"#f0f6fc",borderLeft:"4px solid #2271b1",borderRadius:"2px"},children:[(0,S.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",margin:0},children:[(0,S.jsx)("strong",{children:(0,t.__)("Before you begin","aether-site-exporter-providers")}),(0,S.jsx)(i.Button,{variant:"link",onClick:()=>r(!e),style:{padding:0,height:"auto",minHeight:"auto"},"aria-expanded":e,children:e?(0,t.__)("Hide details","aether-site-exporter-providers"):(0,t.__)("Show details","aether-site-exporter-providers")})]}),!e&&(0,S.jsxs)("p",{style:{margin:"0.5rem 0 0",fontSize:"13px"},children:[(0,t.__)("You need a Cloudflare API token with R2, Workers, and Zone permissions.","aether-site-exporter-providers")," ",(0,S.jsx)(i.ExternalLink,{href:T.createTokenUrl,children:(0,t.__)("Create API Token","aether-site-exporter-providers")})]}),e&&(0,S.jsxs)("div",{style:{marginTop:"0.75rem",fontSize:"13px",lineHeight:"1.6"},children:[(0,S.jsx)("p",{style:{margin:"0 0 0.5rem"},children:(0,t.__)("Create a Cloudflare API token with these permissions:","aether-site-exporter-providers")}),T.sections.map((e,r)=>(0,S.jsxs)("div",{style:{marginBottom:"0.5rem"},children:[(0,S.jsx)("strong",{style:{fontSize:"12px",color:"#50575e"},children:e.title}),(0,S.jsx)("ul",{style:o,children:e.items.map((e,r)=>(0,S.jsxs)("li",{style:n,children:[(0,S.jsx)("code",{children:e.permission})," - ",e.description]},r))})]},r)),(0,S.jsx)("p",{style:{margin:0},children:(0,S.jsx)(i.ExternalLink,{href:T.createTokenUrl,children:(0,t.__)("Create API Token in Cloudflare Dashboard","aether-site-exporter-providers")})})]})]})}function N(){const[e,r]=(0,s.useState)(!1),o={marginBottom:"0.35rem"};return(0,S.jsxs)("div",{style:{marginTop:"0.5rem"},children:[(0,S.jsx)(i.Button,{variant:"link",onClick:()=>r(!e),style:{padding:0,height:"auto",minHeight:"auto",fontSize:"12px"},"aria-expanded":e,children:e?(0,t.__)("Hide token creation steps","aether-site-exporter-providers"):(0,t.__)("How to create an API token","aether-site-exporter-providers")}),e&&(0,S.jsxs)("div",{style:{marginTop:"0.5rem",padding:"0.75rem",backgroundColor:"#f6f7f7",borderRadius:"4px",fontSize:"12px",lineHeight:"1.6"},children:[(0,S.jsxs)("ol",{style:{margin:"0.5rem 0",paddingLeft:"1.25rem"},children:[(0,S.jsx)("li",{style:o,children:(0,t.__)("Go to Cloudflare Dashboard > My Profile > API Tokens","aether-site-exporter-providers")}),(0,S.jsx)("li",{style:o,children:(0,t.__)('Click "Create Token"',"aether-site-exporter-providers")}),(0,S.jsx)("li",{style:o,children:(0,t.__)('Select "Create Custom Token"',"aether-site-exporter-providers")}),(0,S.jsxs)("li",{style:o,children:[(0,t.__)("Add these permissions:","aether-site-exporter-providers"),(0,S.jsxs)("ul",{style:{marginTop:"0.25rem",marginBottom:"0.25rem",paddingLeft:"1.25rem",listStyleType:"disc"},children:[(0,S.jsx)("li",{children:"Account > Workers Scripts > Edit"}),(0,S.jsx)("li",{children:"Account > Workers Routes > Edit"}),(0,S.jsx)("li",{children:"Zone > Zone > Read (select your zones)"})]})]}),(0,S.jsx)("li",{style:o,children:(0,t.__)("Create the token and copy it here","aether-site-exporter-providers")})]}),(0,S.jsx)(i.ExternalLink,{href:"https://developers.cloudflare.com/fundamentals/api/get-started/create-token/",children:(0,t.__)("View Cloudflare Documentation","aether-site-exporter-providers")})]})]})}function A({errorType:e,hostname:r}){const[o,n]=(0,s.useState)(!1),a={marginTop:"0.5rem"},d={padding:0,height:"auto",minHeight:"auto",fontSize:"12px",color:"#2271b1"},c={marginTop:"0.5rem",padding:"0.75rem",backgroundColor:"#fff8e5",borderRadius:"4px",fontSize:"12px",lineHeight:"1.6"},l={margin:"0.5rem 0",paddingLeft:"1.25rem"},p={marginBottom:"0.35rem"};return"worker_deployment"===e?(0,S.jsxs)("div",{style:a,children:[(0,S.jsx)(i.Button,{variant:"link",onClick:()=>n(!o),style:d,"aria-expanded":o,children:o?(0,t.__)("Hide manual instructions","aether-site-exporter-providers"):(0,t.__)("How to deploy manually","aether-site-exporter-providers")}),o&&(0,S.jsxs)("div",{style:c,children:[(0,S.jsx)("p",{style:{margin:"0 0 0.5rem"},children:(0,t.__)("If automatic deployment fails, you can deploy the worker manually:","aether-site-exporter-providers")}),(0,S.jsx)("ol",{style:l,children:C.steps.map((e,r)=>(0,S.jsx)("li",{style:p,children:e},r))}),(0,S.jsx)(i.ExternalLink,{href:C.workersUrl,children:(0,t.__)("Open Workers & Pages","aether-site-exporter-providers")})," | ",(0,S.jsx)(i.ExternalLink,{href:E,children:(0,t.__)("View Bindings Documentation","aether-site-exporter-providers")})]})]}):"domain_attachment"===e?(0,S.jsxs)("div",{style:a,children:[(0,S.jsx)(i.Button,{variant:"link",onClick:()=>n(!o),style:d,"aria-expanded":o,children:o?(0,t.__)("Hide manual instructions","aether-site-exporter-providers"):(0,t.__)("How to attach domain manually","aether-site-exporter-providers")}),o&&(0,S.jsxs)("div",{style:c,children:[(0,S.jsx)("p",{style:{margin:"0 0 0.5rem"},children:(0,t.__)("If custom domain attachment fails, configure it manually:","aether-site-exporter-providers")}),(0,S.jsx)("ol",{style:l,children:I.steps.map((e,t)=>(0,S.jsx)("li",{style:p,children:4===t&&r?`${e}: ${r}`:e},t))}),(0,S.jsx)("p",{style:{marginTop:"0.5rem",fontStyle:"italic",color:"#50575e"},children:I.note}),(0,S.jsx)(i.ExternalLink,{href:I.docsUrl,children:(0,t.__)("View Custom Domains Documentation","aether-site-exporter-providers")})]})]}):null}function $({isOpen:e,onClose:r,bucketName:o}){const[n,a]=(0,s.useState)(!1),[d,c]=(0,s.useState)(""),[l,p]=(0,s.useState)(!1),[u,h]=(0,s.useState)(null);if((0,s.useEffect)(()=>{e&&!d&&(async()=>{p(!0),h(null);try{const e=window.aetherSepPluginUrl||"";if(!e)throw new Error("Plugin URL not available");const r=await fetch(e+"assets/workers/CloudflareR2Worker.js");if(!r.ok)throw new Error(`Failed to fetch worker code: ${r.status}`);const t=await r.text();c(t)}catch(e){h(e.message)}finally{p(!1)}})()},[e,d]),!e)return null;const m={marginBottom:"1.5rem"},f={fontSize:"1rem",fontWeight:"600",marginBottom:"0.5rem",marginTop:0},y={margin:"0.5rem 0",paddingLeft:"1.5rem"},x={marginBottom:"0.5rem",lineHeight:"1.6"};return(0,S.jsx)(i.Modal,{title:(0,t.__)("Manual Worker Setup Instructions","aether-site-exporter-providers"),onRequestClose:r,style:{maxWidth:"800px",width:"90vw"},className:"aether-manual-worker-modal",children:(0,S.jsxs)("div",{className:"aether-manual-worker-modal__content",children:[(0,S.jsxs)("div",{style:m,children:[(0,S.jsx)("h3",{style:f,children:(0,t.__)("Step 1: Create a Worker","aether-site-exporter-providers")}),(0,S.jsxs)("ol",{style:y,children:[(0,S.jsxs)("li",{style:x,children:[(0,t.__)("Go to","aether-site-exporter-providers")," ",(0,S.jsx)("a",{href:"https://dash.cloudflare.com/?to=/:account/workers-and-pages",target:"_blank",rel:"noopener noreferrer",children:"Cloudflare Dashboard > Workers & Pages"})]}),(0,S.jsx)("li",{style:x,children:(0,t.__)('Click "Create" and select "Create Worker"',"aether-site-exporter-providers")}),(0,S.jsx)("li",{style:x,children:(0,t.__)('Name your worker (e.g., "aether-r2-mysite")',"aether-site-exporter-providers")}),(0,S.jsx)("li",{style:x,children:(0,t.__)('Click "Deploy" to create the worker with default code',"aether-site-exporter-providers")})]})]}),(0,S.jsxs)("div",{style:m,children:[(0,S.jsx)("h3",{style:f,children:(0,t.__)("Step 2: Add R2 Bucket Binding","aether-site-exporter-providers")}),(0,S.jsxs)("ol",{style:y,children:[(0,S.jsx)("li",{style:x,children:(0,t.__)("In your worker, go to Settings > Variables","aether-site-exporter-providers")}),(0,S.jsx)("li",{style:x,children:(0,t.__)('Scroll down to "R2 Bucket Bindings"',"aether-site-exporter-providers")}),(0,S.jsx)("li",{style:x,children:(0,t.__)('Click "Add binding"',"aether-site-exporter-providers")}),(0,S.jsxs)("li",{style:x,children:[(0,S.jsx)("strong",{children:(0,t.__)("Variable name:","aether-site-exporter-providers")})," ",(0,S.jsx)("code",{children:"R2_BUCKET"})," ",(0,t.__)("(must be exactly this name)","aether-site-exporter-providers")]}),(0,S.jsxs)("li",{style:x,children:[(0,S.jsx)("strong",{children:(0,t.__)("R2 bucket:","aether-site-exporter-providers")})," ",o?(0,S.jsxs)(S.Fragment,{children:[(0,t.__)("Select","aether-site-exporter-providers")," ",(0,S.jsx)("code",{children:o})]}):(0,t.__)("Select your R2 bucket","aether-site-exporter-providers")]}),(0,S.jsx)("li",{style:x,children:(0,t.__)('Click "Save" to save the binding',"aether-site-exporter-providers")})]})]}),(0,S.jsxs)("div",{style:m,children:[(0,S.jsx)("h3",{style:f,children:(0,t.__)("Step 3: Replace Worker Code","aether-site-exporter-providers")}),(0,S.jsxs)("ol",{style:y,children:[(0,S.jsx)("li",{style:x,children:(0,t.__)('Go to your worker\'s "Code" tab',"aether-site-exporter-providers")}),(0,S.jsx)("li",{style:x,children:(0,t.__)("Delete all existing code","aether-site-exporter-providers")}),(0,S.jsx)("li",{style:x,children:(0,t.__)("Paste the code below:","aether-site-exporter-providers")})]}),(0,S.jsxs)("div",{style:{position:"relative",marginTop:"0.5rem"},children:[l&&(0,S.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"2rem",gap:"0.5rem"},children:[(0,S.jsx)(i.Spinner,{}),(0,S.jsx)("span",{children:(0,t.__)("Loading worker code...","aether-site-exporter-providers")})]}),u&&(0,S.jsx)(i.Notice,{status:"error",isDismissible:!1,children:u}),!l&&!u&&d&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"0.5rem"},children:(0,S.jsx)(i.Button,{variant:"secondary",onClick:async()=>{if(d)try{await navigator.clipboard.writeText(d),a(!0),setTimeout(()=>a(!1),3e3)}catch{const e=document.createElement("textarea");e.value=d,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),a(!0),setTimeout(()=>a(!1),3e3)}},disabled:n,children:n?(0,t.__)("Copied!","aether-site-exporter-providers"):(0,t.__)("Copy Code","aether-site-exporter-providers")})}),(0,S.jsx)(i.TextareaControl,{value:d,readOnly:!0,rows:15,style:{fontFamily:"monospace",fontSize:"12px",backgroundColor:"#1e1e1e",color:"#d4d4d4"}})]})]})]}),(0,S.jsxs)("div",{style:m,children:[(0,S.jsx)("h3",{style:f,children:(0,t.__)("Step 4: Deploy and Copy URL","aether-site-exporter-providers")}),(0,S.jsxs)("ol",{style:y,children:[(0,S.jsx)("li",{style:x,children:(0,t.__)('Click "Save and Deploy" to deploy your worker',"aether-site-exporter-providers")}),(0,S.jsx)("li",{style:x,children:(0,t.__)("Copy the worker URL (e.g., https://aether-r2-mysite.your-subdomain.workers.dev)","aether-site-exporter-providers")}),(0,S.jsx)("li",{style:x,children:(0,t.__)('Paste it in the "Worker Endpoint URL" field in this form',"aether-site-exporter-providers")})]})]}),(0,S.jsxs)(i.Notice,{status:"info",isDismissible:!1,children:[(0,S.jsx)("strong",{children:(0,t.__)("Important:","aether-site-exporter-providers")})," ",(0,t.__)('The R2 bucket binding variable name MUST be exactly "R2_BUCKET" (case-sensitive). The worker will not work without this binding.',"aether-site-exporter-providers")]}),(0,S.jsxs)("div",{style:{backgroundColor:"#f0f6fc",padding:"0.75rem 1rem",borderLeft:"4px solid #2271b1",borderRadius:"2px",marginTop:"1rem",fontSize:"0.875rem"},children:[(0,S.jsx)("strong",{children:(0,t.__)("Need more help?","aether-site-exporter-providers")}),(0,S.jsx)("br",{}),(0,S.jsx)("a",{href:E,target:"_blank",rel:"noopener noreferrer",children:(0,t.__)("R2 Bucket Bindings Documentation","aether-site-exporter-providers")})," | ",(0,S.jsx)("a",{href:"https://developers.cloudflare.com/r2/",target:"_blank",rel:"noopener noreferrer",children:(0,t.__)("R2 Overview","aether-site-exporter-providers")})]}),(0,S.jsx)("div",{style:{marginTop:"1.5rem",display:"flex",justifyContent:"flex-end"},children:(0,S.jsx)(i.Button,{variant:"primary",onClick:r,children:(0,t.__)("Close","aether-site-exporter-providers")})})]})})}function D({providerId:e,config:r,onChange:o}){const[n,a]=(0,s.useState)(!1),[d,c]=(0,s.useState)(null),[l,p]=(0,s.useState)(!1),[u,h]=(0,s.useState)(null),[f,y]=(0,s.useState)(!1),[x,w]=(0,s.useState)(null),[_,g]=(0,s.useState)(!1);return(0,S.jsxs)("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #ddd"},children:[(0,S.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[(0,S.jsx)(i.Button,{variant:"secondary",onClick:async()=>{a(!0),c(null),p(!1),h(null),y(!1),w(null);try{if(!r?.account_id||!r?.api_token||!r?.bucket_name)throw new Error((0,t.__)("Cloudflare Account ID, API Token, and Bucket Name are required to deploy the worker","aether-site-exporter-providers"));const s=(window.aetherData?.restUrl||window.wpApiSettings?.root||"/wp-json").replace(/\/$/,""),i=window.aetherData?.nonce||window.wpApiSettings?.nonce||"",n=`aether-r2-${Math.random().toString(36).substring(2,10)}`,a={};r.bucket_name&&(a.R2_BUCKET={type:"r2_bucket",bucket_name:r.bucket_name});const d=`${s}/aether/site-exporter/providers/cloudflare/deploy-worker`,c=await fetch(d,{method:"POST",headers:{"X-WP-Nonce":i,"Content-Type":"application/json"},body:JSON.stringify({worker_type:"r2",worker_name:n,bindings:a,account_id:r.account_id,api_token:r.api_token})});if(!c.ok){const e=await c.json().catch(()=>({message:`HTTP ${c.status}: ${c.statusText}`}));throw new Error(e.message||e.error||(0,t.__)("Failed to deploy worker","aether-site-exporter-providers"))}const l=await c.json();if(!l.success)throw new Error(l.message||l.error||(0,t.__)("Failed to deploy worker","aether-site-exporter-providers"));if(l.worker_url){o&&"function"==typeof o&&o("worker_endpoint",l.worker_url);try{const r=await m({path:`/aether/site-exporter/providers/${e}/config`,method:"GET"}),t=r?.config||{};await m({path:`/aether/site-exporter/providers/${e}/config`,method:"POST",data:{config:{...t,worker_endpoint:l.worker_url}}})}catch{}}if(l.worker_url&&r.public_url)try{const e=new j(r.account_id,r.api_token,r,"cloudflare-r2-static-site"),o=r.public_url.replace(/^https?:\/\//,"").split("/")[0],s=o.split(".").slice(-2).join("."),i=await e.getZoneIdForHostname(s);if(i.success&&i.data?.zoneId){const r=l.worker_url.match(/https?:\/\/([^.]+)/)?.[1];if(r){const t=await e.attachWorkerToCustomDomain(r,o,i.data.zoneId);t.success?y(!0):w(t.error)}}else w(i.error||(0,t.__)("Could not find zone for domain","aether-site-exporter-providers"))}catch(e){w(e.message)}p(!0),h(l.worker_url||null),setTimeout(()=>{p(!1)},1e4)}catch(e){c(e.message||(0,t.__)("Failed to deploy worker","aether-site-exporter-providers"))}finally{a(!1)}},isBusy:n,disabled:n||!r?.account_id||!r?.api_token||!r?.bucket_name,children:n?(0,t.__)("Deploying…","aether-site-exporter-providers"):(0,t.__)("Deploy Worker","aether-site-exporter-providers")}),(0,S.jsx)(i.Button,{variant:"tertiary",onClick:()=>g(!0),children:(0,t.__)("Manual Setup","aether-site-exporter-providers")})]}),d&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(i.Notice,{status:"error",isDismissible:!1,style:{marginTop:"0.5rem"},children:d}),(0,S.jsx)(A,{errorType:"worker_deployment"})]}),l&&(0,S.jsxs)(i.Notice,{status:"success",isDismissible:!1,style:{marginTop:"0.5rem"},children:[(0,t.__)("Worker deployed successfully!","aether-site-exporter-providers"),u&&(0,S.jsxs)("div",{style:{marginTop:"0.5rem"},children:[(0,S.jsx)("strong",{children:(0,t.__)("Worker URL:","aether-site-exporter-providers")})," ",(0,S.jsx)("a",{href:u,target:"_blank",rel:"noopener noreferrer",children:u})]}),f&&r.public_url&&(0,S.jsxs)("div",{style:{marginTop:"0.5rem"},children:[(0,S.jsx)("strong",{children:(0,t.__)("Custom domain attached:","aether-site-exporter-providers")})," ",(0,S.jsx)("a",{href:r.public_url,target:"_blank",rel:"noopener noreferrer",children:r.public_url.replace(/^https?:\/\//,"").split("/")[0]})]}),x&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("div",{style:{marginTop:"0.5rem",color:"#d63638"},children:[(0,S.jsx)("strong",{children:(0,t.__)("Custom domain warning:","aether-site-exporter-providers")})," ",x]}),(0,S.jsx)(A,{errorType:"domain_attachment",hostname:r.public_url?.replace(/^https?:\/\//,"").split("/")[0]})]})]}),(0,S.jsx)($,{isOpen:_,onClose:()=>g(!1),bucketName:r?.bucket_name})]})}const P=new Map,W=new class{register(e,t){if(!e||"string"!=typeof e)throw new Error("ProviderRegistry.register() requires a valid provider ID string");if(!t||"function"!=typeof t)throw new Error("ProviderRegistry.register() requires a provider class");if(!t.ID)throw new Error(`Provider ${e} must have static ID property`);if(!t.NAME)throw new Error(`Provider ${e} must have static NAME property`);P.set(e,t),(0,r.doAction)("aether.providers.registered",e,t)}get(e){return P.get(e)||null}getAll(){return Array.from(P.values())}getAllIds(){return Array.from(P.keys())}getByDeploymentType(e){return this.getAll().filter(r=>r.DEPLOYMENT_TYPE===e)}getDefault(){const e=this.getByDeploymentType("static_site");if(e.length>0)return e[0];const r=this.getAll();return r.length>0?r[0]:null}getForDeploymentType(e){const r=this.getByDeploymentType(e);return r.length>0?r[0]:null}has(e){return P.has(e)}count(){return P.size}parseInstanceId(e){if(!e||"string"!=typeof e)return null;const r=e.split(":",2);return 2===r.length&&r[0]&&r[1]?{provider_type:r[0],uuid:r[1]}:null}getProviderForInstance(e){const r=this.parseInstanceId(e);return r?this.get(r.provider_type):null}createInstanceId(e){return`${e}:${"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const r=16*Math.random()|0;return("x"===e?r:3&r|8).toString(16)})}`}clear(){P.clear()}};(0,r.addAction)("aether.providers.register","aether/provider-registry",e=>{if(!e||"function"!=typeof e)return;const r=e.ID;r&&W.register(r,e)});let O=W;if("undefined"!=typeof window)if(window.aether=window.aether||{},window.aether.ProviderRegistry){const e=window.aether.ProviderRegistry;Array.from(P.values()).forEach(r=>{const t=r.ID;e.get(t)||e.register(t,r)}),O=e}else window.aether.ProviderRegistry=W;const F=O,U=5242880;async function B(e,r,t,o,s){const i=await fetch(e,{method:"POST",headers:{"Content-Type":"application/octet-stream","X-R2-Key":encodeURIComponent(r),"X-R2-Upload-Id":t,"X-R2-Part-Number":String(o)},body:s});return i.ok&&(await i.json()).etag||null}async function L(e,r,t){return(await fetch(e,{method:"POST",headers:{"Content-Type":"application/json","X-R2-Action":"abort-multipart"},body:JSON.stringify({key:r,uploadId:t})})).ok}async function M(e,r="",t=1e3){const o=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json","X-R2-Action":"list"},body:JSON.stringify({prefix:r,limit:t})});return o.ok?y({objects:(await o.json()).objects||[]}):x(f(await o.text(),`List failed: ${o.status}`))}class z{constructor(e,r,t={}){this.workerEndpoint=e,this.bucketName=r,this.config=t,this.providerId=t.provider_id||""}async upload(e,r,t={}){if(!(r instanceof File||r instanceof Blob))return{success:!1,error:"File must be a File or Blob object"};const o={contentType:t.contentType||r.type,cacheControl:t.cacheControl||"",onProgress:t.onProgress||null},s=await async function(e,r,t,o={}){return t.size>20971520?async function(e,r,t,o={}){const s=t.size,i=o.contentType||t.type||"application/octet-stream",n=o.cacheControl||"",a=await async function(e,r,t,o){const s=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json","X-R2-Action":"initiate-multipart"},body:JSON.stringify({key:r,contentType:t,cacheControl:o})});return s.ok&&(await s.json()).uploadId||null}(e,r,i,n);if(!a)return x("Failed to initiate multipart upload");const d=[],c=Math.ceil(s/U),l=o.onProgress||null;for(let o=1;o<=c;o++){const i=(o-1)*U,n=Math.min(i+U,s),c=t.slice(i,n),p=await c.arrayBuffer(),u=await B(e,r,a,o,p);if(!u)return await L(e,r,a),x(`Failed to upload part ${o}`);if(d.push({partNumber:o,etag:u}),l){const e=o*U;l(Math.min(e,s),s,null)}}const p=await async function(e,r,t,o){return(await fetch(e,{method:"POST",headers:{"Content-Type":"application/json","X-R2-Action":"complete-multipart"},body:JSON.stringify({key:r,uploadId:t,parts:o})})).ok}(e,r,a,d);return p?y():(await L(e,r,a),x("Failed to complete multipart upload"))}(e,r,t,o):async function(e,r,t,o={}){const s=o.contentType||t.type||"application/octet-stream",i=o.cacheControl||"",n=o.onProgress||null;return new Promise((o,a)=>{const d=new XMLHttpRequest;d.timeout=3e5,n&&d.upload.addEventListener("progress",e=>{if(e.lengthComputable){const r=Math.round(e.loaded/e.total*100);n(e.loaded,e.total,r)}}),d.addEventListener("timeout",()=>{a(new Error("Upload timed out after 300000ms"))}),d.addEventListener("load",()=>{if(d.status>=200&&d.status<300)return void o(y());let e=`Upload failed: ${d.status}`;e=f(d.responseText,e),o(x(e))}),d.addEventListener("error",()=>{a(new Error("Upload failed: network error"))}),d.addEventListener("abort",()=>{a(new Error("Upload aborted"))}),d.open("POST",e),d.setRequestHeader("Content-Type","application/octet-stream"),d.setRequestHeader("X-R2-Key",encodeURIComponent(r)),d.setRequestHeader("X-R2-Content-Type",s),i&&d.setRequestHeader("X-R2-Cache-Control",i),d.send(t)})}(e,r,t,o)}(this.workerEndpoint,e,r,o);return s.success?{success:!0,url:this.getUrl(e)}:s}async delete(e){return async function(e,r){const t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json","X-R2-Action":"delete"},body:JSON.stringify({key:r})});return t.ok?y():x(f(await t.text(),`Delete failed: ${t.status}`))}(this.workerEndpoint,e)}async copy(e,r){return async function(e,r,t){const o=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json","X-R2-Action":"copy"},body:JSON.stringify({sourceKey:r,destKey:t})});return o.ok?y():x(f(await o.text(),`Copy failed: ${o.status}`))}(this.workerEndpoint,e,r)}async exists(e){const r=await M(this.workerEndpoint,e,1);return!!r.success&&(r.objects||[]).some(r=>r.key===e)}async listObjects(e="",r=1e3){return M(this.workerEndpoint,e,r)}getUrl(e){return this.config.public_url?`${this.config.public_url.replace(/\/$/,"")}/${e}`:function(e,r,t){return`${e.replace(/\/$/,"")}/${r}/${t}`}(this.workerEndpoint,this.bucketName,e)}async batchCopy(e){return async function(e,r){const t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json","X-R2-Action":"batch-copy"},body:JSON.stringify({operations:r})});if(!t.ok)return x(f(await t.text(),`Batch copy failed: ${t.status}`));const o=await t.json();return y({copied:o.copied||0,errors:o.errors||0,results:o.results||[]})}(this.workerEndpoint,e)}async batchDelete(e){return async function(e,r){const t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json","X-R2-Action":"batch-delete"},body:JSON.stringify({keys:r})});return t.ok?y():x(f(await t.text(),`Batch delete failed: ${t.status}`))}(this.workerEndpoint,e)}async downloadManifest(){const e=this.providerId?`file-manifest-${this.providerId}.json`:"file-manifest.json";try{return await async function(e,r){const t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json","X-R2-Action":"download"},body:JSON.stringify({key:r})});if(!t.ok){if(404===t.status)return null;const e=await t.text();throw new Error(`Download failed: ${t.status} - ${e}`)}return t.blob()}(this.workerEndpoint,e)}catch(e){return null}}async uploadManifest(e){const r=this.providerId?`file-manifest-${this.providerId}.json`:"file-manifest.json";return await this.upload(r,e,{contentType:"application/json"})}async testConnection(){const e=await this.listObjects("",1);return e.success?{success:!0,message:"Successfully connected to Cloudflare R2."}:{success:!1,error:e.error||"Failed to list objects"}}}var q;F.register(o.ID,o),(0,r.doAction)("aether.providers.register",o),(0,r.addFilter)("aether.storage.service.create","aether/cloudflare-r2-static-site",(e,r,t,o,s)=>{if(!o?.startsWith("cloudflare-r2-static-site"))return e;const i=s||t;if(!i?.worker_endpoint||!i?.bucket_name)return null;i.worker_endpoint;const n={...t,public_url:i.public_url||null,provider_id:o};return new z(i.worker_endpoint,i.bucket_name,n)},10),(0,r.addFilter)("aether.provider.test","aether/cloudflare-r2-static-site",(e,r)=>r?.startsWith("cloudflare-r2-static-site")?async()=>{const e=await async function(e){try{return(await m({path:`/aether/site-exporter/providers/${e}/config`,method:"GET"})).config||{}}catch(e){if("restProviderNotConfigured"===e.code||404===e.status)return{};throw e}}(r);return e?.worker_endpoint&&e?.bucket_name?new z(e.worker_endpoint,e.bucket_name,{public_url:e.public_url||null}).testConnection():{success:!1,error:"Storage service not configured. Please set worker_endpoint and bucket_name."}}:e,10),(0,r.addFilter)("aether.provider.upload_strategy","aether/cloudflare-r2-static-site",(e,r)=>r?.startsWith("cloudflare-r2-static-site")?"worker":e,10),q="cloudflare-r2-static-site",(0,r.addFilter)("aether.admin.provider.modal.header",`aether/${q}/setup-guide`,(e,r)=>r.providerId?.startsWith(q)?(0,S.jsx)(R,{}):e),(0,r.addFilter)("aether.admin.provider.field.after",`aether/${q}/api-token-help`,(e,r)=>"api_token"===r.fieldId&&r.providerId?.startsWith(q)?(0,S.jsxs)(S.Fragment,{children:[e,(0,S.jsx)(N,{})]}):e,5),(0,r.addFilter)("aether.admin.provider.field.after",`aether/${q}/deploy-button`,(e,r)=>"worker_endpoint"===r.fieldId&&r.providerId?.startsWith(q)?(0,S.jsxs)(S.Fragment,{children:[e,(0,S.jsx)(D,{providerId:r.providerId,config:r.formValues||{},onChange:r.onFormChange})]}):e,10)})();